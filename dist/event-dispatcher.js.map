{"version":3,"file":"event-dispatcher.js","sources":["../src/index.ts"],"sourcesContent":["export type EventListener = (object?: any) => void;\n// export type EventListenerRemover = () => void;\n\n/**\n * Parent class for typed EventDispatcher subclasses.\n * See https://github.com/amandaghassaei/event-dispatcher#use\n * for an example of how to subclass EventDispatcherPrototype.\n * @param T - The type of events this object should dispatch.\n */\nexport class EventDispatcherPrototype<T> {\n\t/**\n\t * @private\n\t */\n\tprivate __listeners: { [key: string]: EventListener[] } | undefined;\n\n\t/**\n\t * Add one time event listener for a given event type (unsubscriber is called after first dispatch).\n\t * @param type - The type of the event as a string.\n\t * @param listener - An event listener function.\n\t */\n\tprotected _addOneTimeEventListener(type: T, listener: EventListener) {\n\t\tconst _listener = (object: any) => {\n\t\t\tlistener(object);\n\t\t\tthis._removeEventListener(type, _listener);\n\t\t}\n\t\tthis._addEventListener(type, _listener);\n\t\t// return () => {\n\t\t// \tthis._removeEventListener(type, _listener);\n\t\t// };\n\t}\n\n\t/**\n\t * Add an event listener for a given event type.\n\t * @param type - The type of the event as a string.\n\t * @param listener - An event listener function\n\t */\n\tprotected _addEventListener(type: T, listener: EventListener) {\n\t\tif (!this.__listeners) this.__listeners = {};\n\t\tconst listeners = this.__listeners;\n\t\tif (listeners[type as string] === undefined) {\n\t\t\tlisteners[type as string] = [];\n\t\t}\n\t\t// Add listener only if it hasn't been added already.\n\t\tif (listeners[type as string].indexOf(listener) === -1) {\n\t\t\tlisteners[type as string].push(listener);\n\t\t} else {\n\t\t\tconsole.warn(`Event listener \"${listener.name}\" with value ${listener.toString()} has already been added to object ${this.constructor.name}, ignoring call to _addEventListener().`);\n\t\t}\n\t\t// return () => {\n\t\t// \tthis._removeEventListener(type, listener);\n\t\t// };\n\t}\n\n\t/**\n\t * Remove an event listener for a given event type.\n\t * @param type - The type of the event as a string.\n\t * @param listener - The currently bound event listener function.\n\t */\n\tprotected _removeEventListener(type: T, listener: EventListener) {\n\t\tconst listeners = this.__listeners;\n\t\tif (listeners) {\n\t\t\tconst listenerArray = listeners[type as string];\n\t\t\tif (listenerArray) {\n\t\t\t\tconst index = listenerArray.indexOf(listener);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tlistenerArray.splice(index, 1);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthrow new Error(`Event listener \"${listener.name}\" with value ${listener.toString()} is not present on object ${this.constructor.name}, ignoring call to _removeEventListener().`);\n\t}\n\n\t/**\n\t * Dispatch an event from this object.\n\t * @param type - The type of the event as a string.\n\t * @param object - An optional object to pass to event listener function.\n\t */\n\tprotected _dispatchEvent(type: T, object?: any) {\n\t\tif (this.__listeners === undefined) return;\n\t\tconst listeners = this.__listeners;\n\t\tlet listenerArray = listeners[type as string];\n\t\tif (listenerArray) {\n\t\t\t// Make a copy in case listeners are removed while iterating.\n\t\t\tlistenerArray = listenerArray.slice(0);\n\t\t\tfor (let i = 0, l = listenerArray.length; i < l; i ++) {\n\t\t\t\tlistenerArray[i](object);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetNumberOfListenersForEvent(type: T) {\n\t\tconst { __listeners } = this;\n\t\tif (!__listeners) return 0;\n\t\tconst typeListeners = __listeners[type as string];\n\t\tif (!typeListeners) return 0;\n\t\treturn typeListeners.length;\n\t}\n\n\t/**\n\t * Dispose all currently bound listeners from this object.\n\t */\n\tdispose() {\n\t\t// Remove all event listeners.\n\t\tthis.__listeners = undefined;\n\t}\n}"],"names":[],"mappings":"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"}