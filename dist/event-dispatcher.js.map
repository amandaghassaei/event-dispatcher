{"version":3,"file":"event-dispatcher.js","sources":["../src/index.ts"],"sourcesContent":["export type EventListener = (object?: any) => void;\n// export type EventListenerRemover = () => void;\n\n/**\n * Parent class for typed EventDispatcher subclasses.\n * See https://github.com/amandaghassaei/event-dispatcher#use\n * for an example of how to subclass EventDispatcherPrototype.\n * @param T - The type of events this object should dispatch.\n */\nexport class EventDispatcherPrototype<T> {\n\t/**\n\t * @private\n\t */\n\tprivate __listeners: { [key: string]: EventListener[] } | undefined;\n\n\t/**\n\t * Add one time event listener for a given event type (unsubscriber is called after first dispatch).\n\t * @param type - The type of the event as a string.\n\t * @param listener - An event listener function.\n\t */\n\tprotected _prototype_addOneTimeEventListener(type: T, listener: EventListener) {\n\t\tconst _listener = (object: any) => {\n\t\t\tlistener(object);\n\t\t\tthis._prototype_removeEventListener(type, _listener);\n\t\t}\n\t\tthis._prototype_addEventListener(type, _listener);\n\t\t// return () => {\n\t\t// \tthis._removeEventListener(type, _listener);\n\t\t// };\n\t}\n\n\t/**\n\t * Add an event listener for a given event type.\n\t * @param type - The type of the event as a string.\n\t * @param listener - An event listener function\n\t */\n\tprotected _prototype_addEventListener(type: T, listener: EventListener) {\n\t\tif (!this.__listeners) this.__listeners = {};\n\t\tconst listeners = this.__listeners;\n\t\tif (listeners[type as string] === undefined) {\n\t\t\tlisteners[type as string] = [];\n\t\t}\n\t\t// Add listener only if it hasn't been added already.\n\t\tif (listeners[type as string].indexOf(listener) === -1) {\n\t\t\tlisteners[type as string].push(listener);\n\t\t} else {\n\t\t\tconsole.warn(`Event listener \"${listener.name}\" with value ${listener.toString()} has already been added to object ${this.constructor.name}, ignoring call to _addEventListener().`);\n\t\t}\n\t\t// return () => {\n\t\t// \tthis._removeEventListener(type, listener);\n\t\t// };\n\t}\n\n\t/**\n\t * Remove an event listener for a given event type.\n\t * @param type - The type of the event as a string.\n\t * @param listener - The currently bound event listener function.\n\t */\n\tprotected _prototype_removeEventListener(type: T, listener: EventListener) {\n\t\tconst listeners = this.__listeners;\n\t\tif (listeners) {\n\t\t\tconst listenerArray = listeners[type as string];\n\t\t\tif (listenerArray) {\n\t\t\t\tconst index = listenerArray.indexOf(listener);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tlistenerArray.splice(index, 1);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// throw new Error(`Event listener \"${listener.name}\" with value ${listener.toString()} is not present on object ${this.constructor.name}, ignoring call to _removeEventListener().`);\n\t}\n\n\t/**\n\t * Dispatch an event from this object.\n\t * @param type - The type of the event as a string.\n\t * @param object - An optional object to pass to event listener function.\n\t */\n\tprotected _prototype_dispatchEvent(type: T, object?: any) {\n\t\tif (this.__listeners === undefined) return;\n\t\tconst listeners = this.__listeners;\n\t\tlet listenerArray = listeners[type as string];\n\t\tif (listenerArray) {\n\t\t\t// Make a copy in case listeners are removed while iterating.\n\t\t\tlistenerArray = listenerArray.slice(0);\n\t\t\tfor (let i = 0, l = listenerArray.length; i < l; i ++) {\n\t\t\t\tlistenerArray[i](object);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns the number of currently bound listeners for a given event.\n\t * @param type - Event type.\n\t * @returns - The number of currently bound listeners for this event type.\n\t */\n\tgetNumberOfListenersForEvent(type: T) {\n\t\tconst { __listeners } = this;\n\t\tif (!__listeners) return 0;\n\t\tconst typeListeners = __listeners[type as string];\n\t\tif (!typeListeners) return 0;\n\t\treturn typeListeners.length;\n\t}\n\n\t/**\n\t * Dispose all currently bound listeners from this object.\n\t */\n\tdispose() {\n\t\t// Remove all event listeners.\n\t\tthis.__listeners = undefined;\n\t}\n}"],"names":[],"mappings":"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"}